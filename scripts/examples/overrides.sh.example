#!/bin/bash

################################################################################
# Main file: /opt/scripts/update.sh
#
# These are the functions available in the main script that can be overwritten.
#
# func_get_latest_version
# func_download
# func_deploy
# func_create_backup
# func_restore_backup
#
# Available global vars:
#
# EXITSTATUS_SUCCESS
# EXITSTATUS_ERROR
# SERVICE_NAME
# SERVICE_WORKING_DIR
# SERVICE_INSTALLED_VERSION
# SERVICE_APP_ID
# IS_STEAM_GAME
# BASE_DIR
# GLOBAL_SCRIPTS_DIR
# GLOBAL_VERSION_CHECK_FILE
# SERVICE_LATEST_DIR
# SERVICE_TEMP_DIR
# SERVICE_BACKUPS_FOLDER
################################################################################

############################################################################
# OUTPUT:
# - 0: Success (echo "$new_version")
# - 1: Error
############################################################################
function func_get_latest_version() {
  # Get new version
  new_version=""

  if [ -n "$new_version" ]; then
    echo "$new_version"
    return "$EXITSTATUS_SUCCESS"
  else
    return "$EXITSTATUS_ERROR"
  fi
}

############################################################################
# INPUT:
# - $1: Version
#
# OUTPUT:
# - 0: Success
# - 1: Error
############################################################################
function func_download() {
  local version=$1

  # Download new version in $SERVICE_TEMP_DIR

  return "$EXITSTATUS_SUCCESS"
}

############################################################################
# INPUT:
# - $1: Source folder, absolute path
# - $2: Destination folder, absolute path
#
# OUTPUT:
# - 0: Success
# - 1: Error
############################################################################
function func_deploy() {
  local source=$1
  local destination=$2

  # Deploy new version from $SERVICE_TEMP_DIR into $SERVICE_LATEST_DIR

  return "$EXITSTATUS_SUCCESS"
}
